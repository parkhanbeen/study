# 일관성 있는 협력

* 가능하면 유사한 기능을 구현하기 위해 유사한 협력 패턴을 사용하라.
* 객체들의 협력이 전체적으로 일관성 있는 유사한 패턴을 따른다면 시스템을 이해하고 확장하기 위해 요구되는 정신적인 부담을 크게 줄일 수 있다.
* 일관성 있는 설계를 만드는데 가장 훌륭한 조언은 설계 경험을 익히는 것이다.
* 하지만 이런 설계 경험을 단기간에 쌓아 올리는 것은 생각보다 어려운 일이다.

* 일관성 있는 설계를 위한 두 번째 조언은 널리 알려진 디자인 패턴을 학습하고 변경이라는 문맥 안에서 디자인 패턴을 적용해 보는 것이다.
* 디자인 패턴을 학습하면 빠른 시간 안에 전문가의 경험을 흡수할 수 있다.
* 하지만 모든 경우에 적합한 패턴을 찾을 수 있는 것이 아니기 때문에 다음과 같은 기본 지침을 따르는 것이 도움이 될 것이다.
  * 변하는 개념을 변하지 않는 개념으로부터 분리하라.
  * 변하는 개념을 캡슐화하라.

### 캡슐화 다시 살펴보기

* 많은 사람들이 캡슐화에 관한 이야기를 들으면 반사적으로 **데이터 은닉**을 떠올린다.
* 데이터 은닉은 오직 외부에 공개된 메서드를 통해서만 객체의 내부에 접근할 수 있게 제한함으로써 객체 내부의 상태 구현을 숨기는 기법을 가리킨다.
* 그러나 캡슐화는 데이터 은닉 이상이다.
* GOF의 조언에 따르면 캡슐화란 단순히 데이터를 감추는게 아니라 소프트웨어 안에서 변할 수 있는 모든 `개념`을 감추는 것이다.
* 개념이 추상적으로 들린다면 다음과 같이 생각하라
  * `캡슐화란 변하는 어떤 것이든 감추는 것이다`
  
  
## 일관성 있는 협력

* 일관성 있는 협력은 개발자에게 확장 포인트를 강제하기 때문에 정해진 구조를 우회하기 어렵게 만든다.
* 개발자는 코드의 형태로 주어진 제약 안에 머물러야 하지만 작은 문제에 집중할 수 있는 자유를 얻는다.
* 그리고 이 작은 문제에 대한 해결책을 전체 문맥에 연결함으로써 협력을 확장하고 구체화할 수 있다.
* 일단 일관성 있는 협력을 이해하고 나면 변하는 부분만 따로 떼어내어 독립적으로 이해하더라도 전체적인 구조를 쉽게 이해할 수 있다.


* 유사한 기능에대해 유사한 협력 패턴을 적용하는 것은 객체지향 시스템에서 **개념적 무결성(Conceptual Integrity)**을 유지할 수 있는 가장 효과적인
 방법이다.
* 개념적 무결성을 일관성과 동일한 뜻으로 간주해도 무방하다.
* 협력을 설계하고 있다면 항상 기존의 협력 패턴을 따를 수 없는지 고민하라. 그것이 시스템의 개념적 무결성을 지키는 최선의 방법일 것이다.

### 패턴을 찾아라

* 일관성 있는 협력의 핵심은 변경을 분리하고 캡슐화하는 것이다.
* 변경을 캡슐화하는 방법이 협력에 참여하는 개체들의 역할과 책임을 결정하고 이렇게 결정된 협력이 코드의 구조를 결정한다.
* 애플리케이션에서 유사한 기능에 대한 변경이 지속적으로 발생하고 있다면 변경을 캡슐화할 수 있는 적절한 추상화를 찾은 후, 이 추상화에
 변하지 않는 공통적인 책임을 할당하라.
* 현재의 구조가 변경을 캡슐화하기에 적합하지 않다면 코드를 수정하지 않고도 원하는 변경을 수용할 수 있도록 협력과 코드를 리팩터링하라.

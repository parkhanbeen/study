# 지역변수의 범위를 최소화하라

* 지역변수의 유효 범위를 최소로 줄이면 코드 가독성과 유지보수성이 높아지고 오류 가능성은 낮아진다.

## 지역변수의 범위를 줄이는 방법

1. **지역변수의 범위를 줄이는 가장 강력한 기법은 역시 '가장 처음 쓰일 때 선언하기'다.**
   * 사용하려면 멀었는데, 미리 선언부터 해두면 코드가 어수선해져 가독성이 떨어진다.
   * 변수를 실제로 사용하는 시점엔 타입과 초깃값이 기억나지 않을 수도 있다.


2. **거의 모든 지역변수는 선언과 동시에 초기화해야 한다.**
   * 초기화에 필요한 정보가 충분하지 않다면 충분해질 때까지 선언을 미뤄야 한다.
   * `try-catch`문은 예외
     * 변수를 초기화하는 표현식에서 검사 예외를 던질 가능성이 있다면 `try` 블록 안에 초기화해야 한다.
     * 그렇지 않으면 예외가 블록을 넘어 메서드에까지 전파된다.
     * 한편, 변수 값을 `try` 블록 바깥에서도 사용해야 한다면(비록 정확히 초기화하진 못하더라도) `try` 블록 앞에서 선언해야 한다.


3. 반복문의 경우 - `while`문 보다는 `for`문을 사용하자.
   * 반복문은 독특한 방식으로 변수 범위를 최소화해준다.
   * 예전의 `for` 형태든 새로운 `for-each` 형태든, 반복문에서는 반복 변수(loop variable)의 범위가 반복문의 몸체, 그리고 `for` 키워드와 몸체 사이의 
     괄호 안으로 제한된다.
   * 따라서 반복 변수의 값을 반복문이 종료된 뒤에도 써야 하는 상황이 아니라면 `while`문보다는 `for`문을 쓰는 편이 낫다.
   ```java
   // 컬렉션이나 배열을 순회하는 권장 관용구
   for (Element e : c) {
     ...
   }
   ```
   * 반복자를 사용해야 하는 상황이면(반복자의 `remove` 메서드를 써야 한다든가) `for-each` 문 대신 전통적인 `for`문을 쓰는 것이 낫다.
  
   ```java
   // 반복자가 필요할 때의 관용구
   for (Iterator<Element> i = c.iterator(); i.hasNext();) {
     Element e = i.next();
     ...
   }
   ```
  
   * `while`문을 썻을때 발생할 수 있는 버그
   ```java
   Iterator<Element> i = c.iterator();
   while (i.hasNext()) {
     doSomething(i.next());
   }
   
   ...
   
   Iterator<Element> i2 = c2.iterator();
   while (i.hasNext()) {         // 버그
     doSomething(i2.next());
   }
   ```
 
   * 두 번째 `while` 문에는 새로운 반복 변수 `i2`를 초기화 했지만, 실수로 이전 `while`문에서 쓴 `i`를 다시 쓴 것이다.
   * 컴파일도 잘 되고 실행 시 예외도 던지지 않는다.
   * 하지만 두 번째 `while` 문은 `c2`를 순회하지 않고 곧장 끝나버려 `c2`가 비었다고 착각하게 만든다.
   * `for`문을 사용하면 이런 복사 붙여넣기 오류를 컴파일 타임에 알 수 있다.


4. **메서드를 작게 유지하고 한 가지 기능에 집중하라.**
   * 한 메서드에서 여러 가지 기능을 처리한다면 그중한 기능과만 관련된 지역변수라도 다른 기능을 수행하는 코드에서 접근할 수 있을 것이다.
   * 해결법은 **단순히 메서드를 기능별로 쪼개면 된다.**

## 정리

* 지역변수는 가장 처음 쓰일때 선언하자.
* 거의 모든 지역변수는 선언과 동시에 초기화해야 하도록 하자.
* 반복문일 경우 `while`문 보다는 `for`문을 사용하자.
* 메서드를 작게 유지하고 한 가지 기능에 집중하라.
